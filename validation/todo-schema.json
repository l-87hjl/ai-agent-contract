{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://agent-contract.example.com/schemas/todo.json",
  "title": "Agent TODO List",
  "description": "Schema for TODO.json - tracks tasks and their status",
  "type": "object",
  "required": ["version", "lastUpdated", "tasks"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0"]
    },
    "lastUpdated": {
      "type": "string",
      "description": "ISO 8601 timestamp of last update",
      "format": "date-time"
    },
    "tasks": {
      "type": "array",
      "description": "List of tasks",
      "items": {
        "$ref": "#/$defs/task"
      }
    }
  },
  "$defs": {
    "task": {
      "type": "object",
      "required": ["id", "title", "status", "priority", "createdAt", "updatedAt"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique task identifier",
          "pattern": "^task-[a-zA-Z0-9-]+$",
          "examples": ["task-001", "task-profile-001"]
        },
        "title": {
          "type": "string",
          "description": "Short task title",
          "minLength": 1,
          "maxLength": 200
        },
        "description": {
          "type": "string",
          "description": "Detailed task description"
        },
        "status": {
          "type": "string",
          "description": "Current task status",
          "enum": ["pending", "in_progress", "completed", "failed", "blocked"]
        },
        "priority": {
          "type": "string",
          "description": "Task priority level",
          "enum": ["high", "medium", "low"]
        },
        "assignedSession": {
          "type": ["string", "null"],
          "description": "Session ID working on this task"
        },
        "createdAt": {
          "type": "string",
          "description": "When task was created",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "When task was last updated",
          "format": "date-time"
        },
        "completedAt": {
          "type": ["string", "null"],
          "description": "When task was completed",
          "format": "date-time"
        },
        "subtasks": {
          "type": "array",
          "description": "Sub-tasks for complex work",
          "items": {
            "type": "object",
            "required": ["id", "title", "status"],
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^sub-[a-zA-Z0-9-]+$"
              },
              "title": {
                "type": "string"
              },
              "status": {
                "type": "string",
                "enum": ["pending", "in_progress", "completed", "failed", "blocked"]
              }
            }
          }
        },
        "sessionHistory": {
          "type": "array",
          "description": "Sessions that worked on this task",
          "items": {
            "type": "string"
          }
        },
        "prNumber": {
          "type": ["integer", "null"],
          "description": "Associated pull request number"
        },
        "tags": {
          "type": "array",
          "description": "Task tags/labels",
          "items": {
            "type": "string"
          }
        }
      }
    }
  },
  "examples": [
    {
      "version": "1.0.0",
      "lastUpdated": "2026-02-01T14:30:00Z",
      "tasks": [
        {
          "id": "task-001",
          "title": "Implement user authentication",
          "description": "Add login/logout with JWT tokens",
          "status": "in_progress",
          "priority": "high",
          "assignedSession": "session-auth-001",
          "createdAt": "2026-02-01T09:00:00Z",
          "updatedAt": "2026-02-01T14:30:00Z",
          "subtasks": [
            {"id": "sub-001", "title": "Database schema", "status": "completed"},
            {"id": "sub-002", "title": "API endpoints", "status": "in_progress"}
          ]
        }
      ]
    }
  ]
}
